<div class="grid grid-nogutter">
    <div class="col-12 bg-color shadow-1 rounded ml-3">
        <div *ngIf="!loading">
            <div class="tabs-container m-3">
                <div (click)="currentTab = ProjectTabs.List" class="tab"
                     [class.active]="currentTab === ProjectTabs.List">
                    <i class="material-symbols-rounded">view_stream</i>
                    List
                </div>
                <div (click)="currentTab = ProjectTabs.Kanban" class="tab"
                     [class.active]="currentTab === ProjectTabs.Kanban">
                    <i class="material-symbols-rounded">view_kanban</i>
                    Kanban
                </div>
                <div class="tab" (click)="currentTab = ProjectTabs.Timeline"
                     [class.active]="currentTab === ProjectTabs.Timeline">
                    <i class="material-symbols-rounded">calendar_today</i>
                    Timeline
                </div>
            </div>

            <div [ngSwitch]="currentTab">
                <div *ngSwitchCase="ProjectTabs.List">
                    <div class="bg-secondary p-3 pb-0 flex flex-column gap-3">
                        <div class="flex align-items-center justify-content-between">
                            <span class="text-color font-bold text-lg">Tasks</span>

                            <button class="btn filled-btn" (click)="addTask()">
                                <span class="material-symbols-rounded">add</span>
                                New Task
                            </button>
                        </div>
                        <div class="tabs-container">
                            <div (click)="currentListTab = 'all'" class="tab underline"
                                 [class.active]="currentListTab === 'all'">
                                All
                            </div>
                            <div (click)="currentListTab = status.name" *ngFor="let status of statusList"
                                 class="tab underline"
                                 [class.active]="currentListTab === status.name">
                                {{ status.name }}
                            </div>
                        </div>
                    </div>

                    <div class="flex flex-column gap-3">
                        <div class="p-3" *ngFor="let task of project.tasks; let i = index">
                            <app-card *ngIf="currentListTab === 'all' || task.status.name === currentListTab"
                                      [taskProjectId]="projectId" [task]="task" [index]="i"
                                      (updateKanban)="updateKanban()">
                            </app-card>
                        </div>
                    </div>
                </div>
                <div *ngSwitchCase="ProjectTabs.Kanban">
                    <div cdkDropListGroup class="flex md:grid flex-column md:flex-row grid-nogutter gap-5 h-full">
                        <!-- COLUMNS -->
                        <div cdkDropList class="col-12 md:col column p-0 h-auto md:h-97 flex flex-column gap-3 p-2"
                             *ngFor="let status of statusList; let i = index" [cdkDropListData]="project.tasks"
                             (cdkDropListDropped)="drop($event)">
                            <header
                                class="p-3 md:p-0 mb-0 border-bottom-1 md:border-bottom-0 border-300 md:border-transparent">
                                <div class="left-container">
                                    <button class="btn text-btn small-btn" (click)="addTask(status.name)">
                                        <span class="material-symbols-rounded">add</span>
                                    </button>
                                    <span class="title text-color">{{ status.name }}</span>
                                    <span class="task-count">{{ getTasksOfStatus(status.name, project) }}</span>
                                </div>
                            </header>
                            <div class="dropzone">
                                <i class="material-symbols-rounded text-2xl">arrow_drop_down_circle</i>
                            </div>
                            <!-- CARDS -->
                            <div class="grid grid-nogutter gap-3 max-h-30rem md:max-h-30rem h-auto overflow-y-auto">
                                <div *ngFor="let task of project.tasks; let i = index">
                                    <app-card class="col-12 drag-box"
                                              *ngIf="task.status.name === status.name" [taskProjectId]="projectId"
                                              [task]="task" [index]="i"
                                              (updateKanban)="updateKanban()">
                                    </app-card>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!--<div *ngSwitchCase="ProjectTabs.Timeline" class="h-full">
                    <app-kanban-timeline [projectId]="projectId" class="h-full"></app-kanban-timeline>
                </div>-->
            </div>
        </div>
    </div>
</div>
